{% extends "base.html" %}
{% load static %}

{% block content %}

<h1>3x3x3 BLD exec trainer</h1>

<p>Use this trainer to practice executing your 3x3x3 BLD solutions.</p>

<p>It currently provides scramble of a random 3 edges cycle or 3 corner cycle and allows you to memorize and execute your memo, then enter if you succeed or not.</p>

<p>This is useful for both M2/OP and 3 style execution.</p>

<p>Feature to be supported later: Enter your customized letter schema.</p>

<div>
    <label>Select Buffer:</label>
    <label><input type="radio" name="buffer" value="UF" id="buffer-uf" checked> UF Edge Buffer (for 3 style)</label>
    <label><input type="radio" name="buffer" value="DF" id="buffer-df"> DF Edge Buffer (for M2)</label>
    <label><input type="radio" name="buffer" value="UFR" id="buffer-ufr"> UFR Corner Buffer (for 3 style)</label>
    <label><input type="radio" name="buffer" value="UBL" id="buffer-ubl"> UBL Corner Buffer (for OP)</label>
</div>
<button type="button" id="generate-scramble-btn">Generate new 3 edge cycle scramble</button>
<div id="scramble-display" style="margin-top: 1em; font-weight: bold;"></div>
<div style="margin-top: 1em;">
    <button type="button" id="correct-btn" disabled>Correct</button>
    <button type="button" id="incorrect-btn" disabled>Incorrect</button>
</div>
<div id="stats" style="margin-top: 1em;">
    <span>Correct: <span id="correct-count">0</span></span> |
    <span>Incorrect: <span id="incorrect-count">0</span></span> |
    <span>Correct Rate: <span id="correct-rate">0%</span></span>
</div>

<script>
    let correctCount = 0;
    let incorrectCount = 0;

    function updateStats() {
        const total = correctCount + incorrectCount;
        const rate = total === 0 ? 0 : Math.round((correctCount / total) * 100);
        document.getElementById('correct-count').textContent = correctCount;
        document.getElementById('incorrect-count').textContent = incorrectCount;
        document.getElementById('correct-rate').textContent = rate + '%';
        document.getElementById('scramble-display').textContent = '';
    }

    document.getElementById('generate-scramble-btn').addEventListener('click', function() {
        const buffer = document.querySelector('input[name="buffer"]:checked').value;
        fetch(`/3bld/exec_trainer/generate_3_cycle_scramble?buffer=${buffer}`)
            .then(response => response.json())
            .then(data => {
                document.getElementById('scramble-display').textContent = data.scramble || 'No scramble generated.';
                document.getElementById('correct-btn').disabled = false;
                document.getElementById('incorrect-btn').disabled = false;
            })
            .catch(() => {
                document.getElementById('scramble-display').textContent = 'Error generating scramble.';
            });
    });

    document.getElementById('correct-btn').addEventListener('click', function() {
        correctCount++;
        updateStats();
        document.getElementById('correct-btn').disabled = true;
        document.getElementById('incorrect-btn').disabled = true;
    });

    document.getElementById('incorrect-btn').addEventListener('click', function() {
        incorrectCount++;
        updateStats();
        document.getElementById('correct-btn').disabled = true;
        document.getElementById('incorrect-btn').disabled = true;
    });

    updateStats();
</script>

<!--
<h2>Enter Your Letter Schema:</h2>

<table style="border-collapse: collapse;">
    <tr>
        <td></td>
        <td style="width: 50px; height: 50px; border: 1px solid black; padding: 0;">
            <h3>Up</h3>
            <form>
                <table style="border-collapse: collapse;">
                    <tr>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="UB" maxlength="3" value="C"></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><input style="width: 50px;" type="text" id="UL" maxlength="3" value="B"></td>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="UR" maxlength="3" value="D"></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="UF" maxlength="3" value="A"></td>
                        <td></td>
                    </tr>
                </table>
            </form>
        </td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td style="width: 50px; height: 50px; border: 1px solid black; padding: 0;">
            <h3>Left</h3>
            <form>
                <table style="border-collapse: collapse;">
                    <tr>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="LU" maxlength="3" value="M"></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><input style="width: 50px;" type="text" id="LB" maxlength="3" value="P"></td>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="LF" maxlength="3" value="N"></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="LD" maxlength="3" value="O"></td>
                        <td></td>
                    </tr>
                </table>
            </form>
        </td>
        <td style="width: 50px; height: 50px; border: 1px solid black; padding: 0;">
            <h3>Front</h3>
            <form>
                <table style="border-collapse: collapse;">
                    <tr>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="FU" maxlength="3" value="I"></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><input style="width: 50px;" type="text" id="FL" maxlength="3" value="L"></td>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="FR" maxlength="3" value="J"></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="FD" maxlength="3" value="K"></td>
                        <td></td>
                    </tr>
                </table>
            </form>
        </td>
        <td style="width: 50px; height: 50px; border: 1px solid black; padding: 0;">
            <h3>Right</h3>
            <form>
                <table style="border-collapse: collapse;">
                    <tr>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="RU" maxlength="3" value="W"></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><input style="width: 50px;" type="text" id="RF" maxlength="3" value="Z"></td>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="RB" maxlength="3" value="X"></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="RD" maxlength="3" value="Y"></td>
                        <td></td>
                    </tr>
                </table>
            </form>
        </td>
        <td style="width: 50px; height: 50px; border: 1px solid black; padding: 0;">
            <h3>Back</h3>
            <form>
                <table style="border-collapse: collapse;">
                    <tr>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="BU" maxlength="3" value="Q"></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><input style="width: 50px;" type="text" id="BR" maxlength="3" value="T"></td>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="BL" maxlength="3" value="R"></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="BD" maxlength="3" value="S"></td>
                        <td></td>
                    </tr>
                </table>
            </form>
        </td>
    </tr>
    <tr>
        <td></td>
        <td style="width: 50px; height: 50px; border: 1px solid black; padding: 0;">
            <h3>Down</h3>
            <form>
                <table style="border-collapse: collapse;">
                    <tr>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="DF" maxlength="3" value="E"></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><input style="width: 50px;" type="text" id="DL" maxlength="3" value="F"></td>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="DR" maxlength="3" value="H"></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><input style="width: 50px;" type="text" id="DB" maxlength="3" value="G"></td>
                        <td></td>
                    </tr>
                </table>
            </form>
        </td>
        <td></td>
        <td></td>
    </tr>
</table>

<script>
    // Global dictionary to store the key-value pairs
    const letterSchema = {};

    // Function to update the displayed HTML dynamically
    function UpdateHTML() {
        // let entries = [];
        // for (const [key, value] of Object.entries(hardcodedMap)) {
        //     const userValue = document.getElementById(key).value || key;
        //     entries.push({ userValue, value });
        // }
        // entries.sort((a, b) => a.userValue.localeCompare(b.userValue));
        // let updatedCode = "";
        // for (const { userValue, value } of entries) {
        //     updatedCode += `<li>${userValue}: ${value}</li>\n`;
        // }
        // document.getElementById("generatedList").innerHTML = `<ul>${updatedCode}</ul>`;
    }

    // Add an event listener to call UpdateHTML whenever Update is triggered
    function Update(key) {
        const inputElement = document.getElementById(key);
        if (inputElement) {
            letterSchema[key] = inputElement.value;
        }
        UpdateHTML(); // Update the displayed HTML
    }

    // Initialize the displayed HTML on page load
    window.onload = function () {
        const inputs = document.querySelectorAll('input[type="text"]');
        inputs.forEach(input => {
            letterSchema[input.id] = input.value || "";
        });
        UpdateHTML(); // Populate the initial HTML
    };

    const idsToSync = [...new Set(Array.from(document.querySelectorAll('input[type="text"]')).map(input => input.id))]
        .filter(id => /^[A-Z]{2}/.test(id));
    idsToSync.forEach(id => {
        const input = document.getElementById(`${id}`);
        input.addEventListener('input', (e) => {
            Update(e.target.id);
        });
    });
</script>
-->



{% endblock content %}