{% extends "base.html" %}
{% load static %}

{% block content %}
<h1>
    7 Simul Flip Improved (7sf+)
</h1>
<p>
    After reading <a href="/clock/7simul_flip_intro">intro to 7 simul flip</a>, you may notice some of the suboptimal part of it.<br>
    First of all, before x2, there is an instruction to quickly inspect the C - U which will be later applied in solve on the new face.<br>
    With practice, this might become an instinct, but the number actually remains unchanged throughout the process. Therefore, memorizing C - U as M5 is very simple during inspection.<br>
    Another suboptimal part is during step 5, we need to align ur to dl, while dl is subject to change. However, this number is simply U - L which could be memorized as M6 during inspection.<br>
    These are the two optimization that most 7 simul flip solvers adopt for quicker solves.<br>
    In this page, I will present how to calculate each of the 14 moves during inspection.<br>
    <u>If you are curious, see the derivations in <a href="/clock/7simul_flip_theory">theoretical derivation</a>.</u>
</p>

<h2>
    Applications
</h2>
<p>
    The first application, is you may decide to memorize 6 &le; X &le; 14 steps during inspection. So you can more efficiently speed solve the puzzle.<br>
    The second application, is you may memorize 14 steps and then blindfold the puzzle.<br>
    Another clock blindfold method would be to remember the position of each of the 14 clock face (corner clock are always identical on both sides). Then solve them one by one using a fixed algorithm.<br>
    This method would be much faster to execute, although much more calculation during the memorization.
</p>

<h2>
    Method
</h2>
<p>
    We now demonstrate this method with the same example as before.
</p>

<div id="appendable-div">
</div>

<h2>
    Summary
</h2>
<p>
    The method is compiled as a table below, and also showing a recommended progression path you may follow for your speedsolve.<br>
    I personally use milestone 3 which is easy to memorize under 15 seconds with practice, and able to trim down my execution time by about 1 second, compared with milestone 1.<br>
    <u>Tips: for milestone 3, I have updated the memo order to M1, M2, M4, M3, M5, M6, M8, M7, which reduce the number of x2 during the memo.</u><br>
</p>
<p><strong>Milestone 1: Same as intro</strong></p>
<table border="1" style="width: 100%; text-align: center;">
    <thead>
        <tr>
            <th>Pin Location</th>
            <th>Left Dial</th>
            <th>Right Dial</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>dr</td>
            <td>M1 = D - R + ul - l</td>
            <td>M2 = c - u</td>
        </tr>
        <tr>
            <td>L</td>
            <td>Align D to R</td>
            <td>M3 = u - l</td>
        </tr>
        <tr>
            <td>UL</td>
            <td>Align C to R</td>
            <td>Align DR to R</td>
        </tr>
        <tr>
            <td>(After x2) ur</td>
            <td>M4 = -r+d-L+UL</td>
            <td>Before x2, inspect and memorize C - U</td>
        </tr>
        <tr>
            <td>L</td>
            <td>Align d to r</td>
            <td>Align ur to dl after left dial is done</td>
        </tr>
        <tr>
            <td>UL</td>
            <td>Align c to r</td>
            <td>Align dr to r</td>
        </tr>
        <tr>
            <td>\</td>
            <td>AUF ul</td>
            <td>AUF ur</td>
        </tr>
    </tbody>
</table>

<p><strong>Milestone 2: Memorize 6 numbers</strong></p>
<table border="1" style="width: 100%; text-align: center;">
    <thead>
        <tr>
            <th>Pin Location</th>
            <th>Left Dial</th>
            <th>Right Dial</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>dr</td>
            <td>M1 = D - R + ul - l</td>
            <td>M2 = c - u</td>
        </tr>
        <tr>
            <td>L</td>
            <td>Align D to R</td>
            <td>M3 = u - l</td>
        </tr>
        <tr>
            <td>UL</td>
            <td>Align C to R</td>
            <td>Align DR to R</td>
        </tr>
        <tr>
            <td>(After x2) ur</td>
            <td>M4 = -r+d-L+UL</td>
            <td>M5 = C - U</td>
        </tr>
        <tr>
            <td>L</td>
            <td>Align d to r</td>
            <td>M6 = U - L</td>
        </tr>
        <tr>
            <td>UL</td>
            <td>Align c to r</td>
            <td>Align dr to r</td>
        </tr>
        <tr>
            <td>\</td>
            <td>AUF ul</td>
            <td>AUF ur</td>
        </tr>
    </tbody>
</table>

<p><strong>Milestone 3: Memorize 8 numbers (highly recommended)</strong></p>
<table border="1" style="width: 100%; text-align: center;">
    <thead>
        <tr>
            <th>Pin Location</th>
            <th>Left Dial</th>
            <th>Right Dial</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>dr</td>
            <td>M1 = D - R + ul - l</td>
            <td>M2 = c - u</td>
        </tr>
        <tr>
            <td>L</td>
            <td>M3 = R - D</td>
            <td>M4 = u - l</td>
        </tr>
        <tr>
            <td>UL</td>
            <td>Align C to R</td>
            <td>Align DR to R</td>
        </tr>
        <tr>
            <td>(After x2) ur</td>
            <td>M5 = -r+d-L+UL</td>
            <td>M6 = C - U</td>
        </tr>
        <tr>
            <td>L</td>
            <td>M7 = r - d</td>
            <td>M8 = U - L</td>
        </tr>
        <tr>
            <td>UL</td>
            <td>Align c to r</td>
            <td>Align dr to r</td>
        </tr>
        <tr>
            <td>\</td>
            <td>AUF ul</td>
            <td>AUF ur</td>
        </tr>
    </tbody>
</table>

<p><strong>Milestone 4: Memorize 14 numbers (For Clock Speed BLD)</strong></p>
<table border="1" style="width: 100%; text-align: center;">
    <thead>
        <tr>
            <th>Pin Location</th>
            <th>Left Dial</th>
            <th>Right Dial</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>dr</td>
            <td>M1 = D - R + ul - l</td>
            <td>M2 = c - u</td>
        </tr>
        <tr>
            <td>L</td>
            <td>M3 = R - D</td>
            <td>M4 = u - l</td>
        </tr>
        <tr>
            <td>UL</td>
            <td>M5 = D - C</td>
            <td>M6 = R - DR + l - u</td>
        </tr>
        <tr>
            <td>(After x2) ur</td>
            <td>M7 = d - r + UL - L</td>
            <td>M8 = C - U</td>
        </tr>
        <tr>
            <td>L</td>
            <td>M9 = r - d</td>
            <td>M10 = U - L</td>
        </tr>
        <tr>
            <td>UL</td>
            <td>M11 = d - c</td>
            <td>M12 = r - dr + L - U</td>
        </tr>
        <tr>
            <td>\</td>
            <td>M13 = R + L - UL - DR + c - u - d</td>
            <td>M14 = U + D - C - DL - UR - l - r</td>
        </tr>
    </tbody>
</table>

<h2>Skip Cases</h2>
<p>One key property of the 7 simul flip method, is that except for the 7-th move M13 and M14 in 14 numbers memo, which is not recommended to be memorized for speed solving anyway.</p>
<p>The clock can be held in any of the 4 directions (North, East, South, West), without affecting the memo.</p>
<p>Also notice that there are two memos C - U and U - L.</p>
<p>At the beginning of inspection, you may quickly identify if there is an edge clock identical to center (on either face) or an edge clock identical to an diagonally adjacent edge clock.</p>
<p>If this is the case, quickly set them up in either C/U position or U/L position. And hold the clock from that angle to start inspection.</p>
<p>This will guarantee either C - U = 0 or U - L = 0, without too much calculation involved.</p>
<p>You may choose to setup these positions into c - u, u - l, R - D, r - d. But C/U and U/L position are quite easy to master, and has good value compared to c - u or u - l because first few moves can be easily simultaneously executed if you get prepared for these few moves during inspection. For moves after flip, it's very hard to execute simultaneously due to the flip movement.</p>

<p>We also calculated the probability of such a skip:</p>
<p>The problem is: There are X1, X2, X3, X4, X5, Y1, Y2, Y3, Y4, Y5. They are independently uniform distribution of {0, 1, 2, ..., 11}. Calculate the probability that at least one of the following is true: X1=X2, X1=X3, X1=X4, X1=X5, X2=X3, X3=X4, X4=X5, X5=X2, Y1=Y2, ... (replace all X to Y and repeat).</p>
<p>Denote the probability of any of X1=X2, X1=X3, X1=X4, X1=X5, X2=X3, X3=X4, X4=X5, X5=X2 as p. The answer will be $$2p - p^2$$ since X and Y are independent set.</p>
<p>The probability p can be calculated with the following Python3 program:</p>
<pre>
    from itertools import product

    # Define the range of values for X1, X2, X3, X4, X5
    values = range(12)
    
    # Initialize a counter for valid combinations
    valid_combinations = 0
    
    # Total number of combinations
    total_combinations = 12 ** 5
    
    # Iterate through all possible combinations of X1, X2, X3, X4, X5
    for combination in product(values, repeat=5):
        X1, X2, X3, X4, X5 = combination
        # Check if at least one condition is satisfied
        if (X1 == X2 or X1 == X3 or X1 == X4 or X1 == X5 or
            X2 == X3 or X3 == X4 or X4 == X5 or X5 == X2):
            valid_combinations += 1
    
    # Calculate the ratio
    ratio = valid_combinations / total_combinations
    
    # Print the results
    print(f"Number of valid combinations: {valid_combinations}")
    print(f"Total number of combinations: {total_combinations}")
    print(f"Ratio: {ratio}")
</pre>
<p>The resulting p is 0.5172646604938271</p>
<p>Therefore 2p - p^2 = 0.7669</p>
<p>In practice, the chance of getting this skip is more than 3/4.</p>


<h2>Further Reading</h2>
<p>There are some discussion on <a href="https://www.speedsolving.com/threads/clock-blind.93140/">Clock BLD</a> and the author introduced an approach similar to the one introduced here although without theoretical derivation.</p>
<p><a href="https://www.youtube.com/watch?v=X84OW0Znqg4">This YouTube video</a> explains how to do clock BLD with 7 simul Tommy's version.</p>

<script>
    // Get Django variable safely into JavaScript
    const table_data = JSON.parse('{{ table_data|escapejs }}');

    for (let i = 0; i < table_data.length; i++) {
        const li = document.createElement("div");
        li.innerHTML = table_data[i].paragraph;
        li.id = `item-${i}`;
        document.getElementById("appendable-div").appendChild(li);
        const viz = document.createElement("div");
        viz.style = "max-width: 640px; margin: auto;";
        const adj = document.createElement("div");
        adj.id = `adjuster-${i}`;
        adj.className = "has-text-centered";
        const canvas = document.createElement("canvas");
        canvas.id = `canvas-${i}`;
        adj.appendChild(canvas);
        viz.appendChild(adj);
        document.getElementById("appendable-div").appendChild(viz);
        let scramble = table_data[i].scramble.split(',').map(Number);
        let operations = table_data[i].operations.split(',').map(Number);
        let clocks = makeClocks(scramble, operations);
        if (!table_data[i].annotation) {
            table_data[i].annotation = null;
        }
        if (!table_data[i].operations) {
            table_data[i].operations = null;
        }
        if (!table_data[i].change_pins) {
            table_data[i].change_pins = null;
        }
        let plot_pointer = true;
        if (table_data[i].annotation && table_data[i].annotation.startsWith("UL")) {
            plot_pointer = false;
        }
        render(clocks, "x2", adj.id, canvas.id, convert_to_matrix(table_data[i].annotation), convert_to_change_pin_matrix(table_data[i].change_pins), plot_pointer);
    }
</script>

{% endblock content %}